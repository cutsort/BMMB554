<!doctype html>
<html lang="en" class="h-100">
  <head>
  <meta name="generator" content="Hugo 0.62.1" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="https://nekrut.github.io/BMMB554/css/bootstrap.min.css">
  
  
  <title>Lecture 7: Plotting in Python | BMMB554</title>
  <style>
.container {
  max-width: 800px;
}
#nav a {
  font-weight: bold;
  color: inherit;
}
#nav a.nav-link-active {
  background-color: #212529;
  color: #fff;
}
#nav-border {
  border-bottom: 1px solid #212529;
}
#main {
  margin-top: 1em;
  margin-bottom: 4em;
}
#home-jumbotron {
  background-color: inherit;
}
#footer .container {
  padding: 1em 0;
}
#footer a {
  color: inherit;
  text-decoration: underline;
}
.font-125 {
  font-size: 125%;
}
.tag-btn {
  margin-bottom: 0.3em;
}
pre {
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  padding: 16px;
}
pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  background-color: transparent;
  border-radius: 0;
}
code {
  padding: 2px 4px;
  font-size: 90%;
  color: #c7254e;
  background-color: #f9f2f4;
  border-radius: 4px;
}
img {
  max-width: 100%;
}
</style>

  <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>
  
</head>
  <body class="d-flex flex-column h-100">
    <div id="nav-border" class="container">
  <nav id="nav" class="nav justify-content-center">
  
  
  
    
    
      
        
      
    
    
    <a class="nav-link " href="/BMMB554/"><i data-feather="home"></i> Home</a>
  
    
    
      
        
      
    
    
    <a class="nav-link " href="/BMMB554/post/"><i data-feather="book-open"></i> Lectures</a>
  
    
    
      
        
      
    
    
    <a class="nav-link " href="/BMMB554/tags/"><i data-feather="tag"></i> Tags</a>
  
    
    
      
        
      
    
    
    <a class="nav-link " href="/BMMB554/about/"><i data-feather="list"></i> Syllabus</a>
  
  </nav>
</div>
    <div class="container">
      <main id="main">
        

<h1>Lecture 7: Plotting in Python</h1>


<i data-feather="calendar"></i> <time datetime="2020-02-12">Feb 12, 2020</time>

  <br>
  <i data-feather="tag"></i>
  
  
  <a class="btn btn-sm btn-outline-dark tag-btn" href="https://nekrut.github.io/BMMB554/tags/python">python</a>
  
  
  <a class="btn btn-sm btn-outline-dark tag-btn" href="https://nekrut.github.io/BMMB554/tags/seaborn">seaborn</a>
  
  
  <a class="btn btn-sm btn-outline-dark tag-btn" href="https://nekrut.github.io/BMMB554/tags/motplotlib">motplotlib</a>
  
  
  <a class="btn btn-sm btn-outline-dark tag-btn" href="https://nekrut.github.io/BMMB554/tags/plotting">plotting</a>
  

<br><br>
<div class="alert alert-info" role="alert">
  This lecture draws extensively from <a href="https://seaborn.pydata.org/tutorial.html">Seaborn tutorials</a>.
</div>
<h1 id="a-primer-of-plotting-with-python">A primer of plotting with Python</h1>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># If running in colaboratory uncomment and run the folliwing command</span>
pip install seaborn <span style="color:#666">-</span><span style="color:#666">-</span>upgrade
pip install pysqldf
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">pandasql</span> <span style="color:#008000;font-weight:bold">import</span> sqldf
pysqldf <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">lambda</span> q: sqldf(q, <span style="color:#008000">globals</span>())

<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">seaborn</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">sns</span>
sns<span style="color:#666">.</span>set(style<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">ticks</span><span style="color:#ba2121">&#34;</span>)

<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">pandas</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">pd</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">matplotlib.pyplot</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">plt</span>
</code></pre></div><h1 id="why-plotting">Why plotting?</h1>
<p>We will use <a href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet">Ascombe's quartet</a> build into Seaborn to answer this questions</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Load the example dataset for Anscombe&#39;s quartet</span>
df <span style="color:#666">=</span> sns<span style="color:#666">.</span>load_dataset(<span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">anscombe</span><span style="color:#ba2121">&#34;</span>)
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table class="table table-striped table-responsive">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>x</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>I</td>
      <td>10.0</td>
      <td>8.04</td>
    </tr>
    <tr>
      <th>1</th>
      <td>I</td>
      <td>8.0</td>
      <td>6.95</td>
    </tr>
    <tr>
      <th>2</th>
      <td>I</td>
      <td>13.0</td>
      <td>7.58</td>
    </tr>
    <tr>
      <th>3</th>
      <td>I</td>
      <td>9.0</td>
      <td>8.81</td>
    </tr>
    <tr>
      <th>4</th>
      <td>I</td>
      <td>11.0</td>
      <td>8.33</td>
    </tr>
    <tr>
      <th>5</th>
      <td>I</td>
      <td>14.0</td>
      <td>9.96</td>
    </tr>
    <tr>
      <th>6</th>
      <td>I</td>
      <td>6.0</td>
      <td>7.24</td>
    </tr>
    <tr>
      <th>7</th>
      <td>I</td>
      <td>4.0</td>
      <td>4.26</td>
    </tr>
    <tr>
      <th>8</th>
      <td>I</td>
      <td>12.0</td>
      <td>10.84</td>
    </tr>
    <tr>
      <th>9</th>
      <td>I</td>
      <td>7.0</td>
      <td>4.82</td>
    </tr>
    <tr>
      <th>10</th>
      <td>I</td>
      <td>5.0</td>
      <td>5.68</td>
    </tr>
    <tr>
      <th>11</th>
      <td>II</td>
      <td>10.0</td>
      <td>9.14</td>
    </tr>
    <tr>
      <th>12</th>
      <td>II</td>
      <td>8.0</td>
      <td>8.14</td>
    </tr>
    <tr>
      <th>13</th>
      <td>II</td>
      <td>13.0</td>
      <td>8.74</td>
    </tr>
    <tr>
      <th>14</th>
      <td>II</td>
      <td>9.0</td>
      <td>8.77</td>
    </tr>
    <tr>
      <th>15</th>
      <td>II</td>
      <td>11.0</td>
      <td>9.26</td>
    </tr>
    <tr>
      <th>16</th>
      <td>II</td>
      <td>14.0</td>
      <td>8.10</td>
    </tr>
    <tr>
      <th>17</th>
      <td>II</td>
      <td>6.0</td>
      <td>6.13</td>
    </tr>
    <tr>
      <th>18</th>
      <td>II</td>
      <td>4.0</td>
      <td>3.10</td>
    </tr>
    <tr>
      <th>19</th>
      <td>II</td>
      <td>12.0</td>
      <td>9.13</td>
    </tr>
    <tr>
      <th>20</th>
      <td>II</td>
      <td>7.0</td>
      <td>7.26</td>
    </tr>
    <tr>
      <th>21</th>
      <td>II</td>
      <td>5.0</td>
      <td>4.74</td>
    </tr>
    <tr>
      <th>22</th>
      <td>III</td>
      <td>10.0</td>
      <td>7.46</td>
    </tr>
    <tr>
      <th>23</th>
      <td>III</td>
      <td>8.0</td>
      <td>6.77</td>
    </tr>
    <tr>
      <th>24</th>
      <td>III</td>
      <td>13.0</td>
      <td>12.74</td>
    </tr>
    <tr>
      <th>25</th>
      <td>III</td>
      <td>9.0</td>
      <td>7.11</td>
    </tr>
    <tr>
      <th>26</th>
      <td>III</td>
      <td>11.0</td>
      <td>7.81</td>
    </tr>
    <tr>
      <th>27</th>
      <td>III</td>
      <td>14.0</td>
      <td>8.84</td>
    </tr>
    <tr>
      <th>28</th>
      <td>III</td>
      <td>6.0</td>
      <td>6.08</td>
    </tr>
    <tr>
      <th>29</th>
      <td>III</td>
      <td>4.0</td>
      <td>5.39</td>
    </tr>
    <tr>
      <th>30</th>
      <td>III</td>
      <td>12.0</td>
      <td>8.15</td>
    </tr>
    <tr>
      <th>31</th>
      <td>III</td>
      <td>7.0</td>
      <td>6.42</td>
    </tr>
    <tr>
      <th>32</th>
      <td>III</td>
      <td>5.0</td>
      <td>5.73</td>
    </tr>
    <tr>
      <th>33</th>
      <td>IV</td>
      <td>8.0</td>
      <td>6.58</td>
    </tr>
    <tr>
      <th>34</th>
      <td>IV</td>
      <td>8.0</td>
      <td>5.76</td>
    </tr>
    <tr>
      <th>35</th>
      <td>IV</td>
      <td>8.0</td>
      <td>7.71</td>
    </tr>
    <tr>
      <th>36</th>
      <td>IV</td>
      <td>8.0</td>
      <td>8.84</td>
    </tr>
    <tr>
      <th>37</th>
      <td>IV</td>
      <td>8.0</td>
      <td>8.47</td>
    </tr>
    <tr>
      <th>38</th>
      <td>IV</td>
      <td>8.0</td>
      <td>7.04</td>
    </tr>
    <tr>
      <th>39</th>
      <td>IV</td>
      <td>8.0</td>
      <td>5.25</td>
    </tr>
    <tr>
      <th>40</th>
      <td>IV</td>
      <td>19.0</td>
      <td>12.50</td>
    </tr>
    <tr>
      <th>41</th>
      <td>IV</td>
      <td>8.0</td>
      <td>5.56</td>
    </tr>
    <tr>
      <th>42</th>
      <td>IV</td>
      <td>8.0</td>
      <td>7.91</td>
    </tr>
    <tr>
      <th>43</th>
      <td>IV</td>
      <td>8.0</td>
      <td>6.89</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>groupby(<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">dataset</span><span style="color:#ba2121">&#39;</span>)<span style="color:#666">.</span>describe()
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead tr th {
    text-align: left;
}

.dataframe thead tr:last-of-type th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table class="table table-striped table-responsive">
  <thead>
    <tr>
      <th></th>
      <th colspan="8" halign="left">x</th>
      <th colspan="8" halign="left">y</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>dataset</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I</th>
      <td>11.0</td>
      <td>9.0</td>
      <td>3.316625</td>
      <td>4.0</td>
      <td>6.5</td>
      <td>9.0</td>
      <td>11.5</td>
      <td>14.0</td>
      <td>11.0</td>
      <td>7.500909</td>
      <td>2.031568</td>
      <td>4.26</td>
      <td>6.315</td>
      <td>7.58</td>
      <td>8.57</td>
      <td>10.84</td>
    </tr>
    <tr>
      <th>II</th>
      <td>11.0</td>
      <td>9.0</td>
      <td>3.316625</td>
      <td>4.0</td>
      <td>6.5</td>
      <td>9.0</td>
      <td>11.5</td>
      <td>14.0</td>
      <td>11.0</td>
      <td>7.500909</td>
      <td>2.031657</td>
      <td>3.10</td>
      <td>6.695</td>
      <td>8.14</td>
      <td>8.95</td>
      <td>9.26</td>
    </tr>
    <tr>
      <th>III</th>
      <td>11.0</td>
      <td>9.0</td>
      <td>3.316625</td>
      <td>4.0</td>
      <td>6.5</td>
      <td>9.0</td>
      <td>11.5</td>
      <td>14.0</td>
      <td>11.0</td>
      <td>7.500000</td>
      <td>2.030424</td>
      <td>5.39</td>
      <td>6.250</td>
      <td>7.11</td>
      <td>7.98</td>
      <td>12.74</td>
    </tr>
    <tr>
      <th>IV</th>
      <td>11.0</td>
      <td>9.0</td>
      <td>3.316625</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>19.0</td>
      <td>11.0</td>
      <td>7.500909</td>
      <td>2.030579</td>
      <td>5.25</td>
      <td>6.170</td>
      <td>7.04</td>
      <td>8.19</td>
      <td>12.50</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Show the results of a linear regression within each dataset</span>
sns<span style="color:#666">.</span>lmplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">x</span><span style="color:#ba2121">&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">y</span><span style="color:#ba2121">&#34;</span>, col<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">dataset</span><span style="color:#ba2121">&#34;</span>, hue<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">dataset</span><span style="color:#ba2121">&#34;</span>, data<span style="color:#666">=</span>df,
           col_wrap<span style="color:#666">=</span><span style="color:#666">2</span>, ci<span style="color:#666">=</span>None
           )
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6abe1548d0&gt;
</code></pre>
<p><img src="/BMMB554/img/output_7_1.png" alt="png"></p>
<h2 id="lets-look-at-tnseq-data-again">Let's look at TnSeq data again</h2>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
wget https://nekrut.github.io/BMMB554/tnseq_untreated.txt.gz
wget https://nekrut.github.io/BMMB554/ta_gc.txt
</code></pre></div><pre><code>--2019-02-04 18:36:13--  https://nekrut.github.io/BMMB554/tnseq_untreated.txt.gz
Resolving nekrut.github.io... 185.199.111.153, 185.199.109.153, 185.199.110.153, ...
Connecting to nekrut.github.io|185.199.111.153|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2012967 (1.9M) [application/gzip]
Saving to: ‘tnseq_untreated.txt.gz’


2019-02-04 18:36:14 (9.19 MB/s) - ‘tnseq_untreated.txt.gz.1’ saved [2012967/2012967]

--2019-02-04 18:36:14--  https://nekrut.github.io/BMMB554/ta_gc.txt
Resolving nekrut.github.io... 185.199.111.153, 185.199.109.153, 185.199.110.153, ...
Connecting to nekrut.github.io|185.199.111.153|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 7315570 (7.0M) [text/plain]
Saving to: ‘ta_gc.txt’
</code></pre>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data_file <span style="color:#666">=</span> <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">tnseq_untreated.txt.gz</span><span style="color:#ba2121">&#39;</span>
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Process tnseq_untreated.txt.gz to correctly parse gene names</span>

<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">os</span>
f <span style="color:#666">=</span> <span style="color:#008000">open</span>(<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">data.txt</span><span style="color:#ba2121">&#39;</span>,<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">w</span><span style="color:#ba2121">&#39;</span>)

<span style="color:#008000;font-weight:bold">with</span> os<span style="color:#666">.</span>popen(<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">gunzip -c {}</span><span style="color:#ba2121">&#39;</span><span style="color:#666">.</span>format(data_file)) <span style="color:#008000;font-weight:bold">as</span> stream:
  <span style="color:#008000;font-weight:bold">for</span> line <span style="color:#a2f;font-weight:bold">in</span> stream:
    <span style="color:#008000;font-weight:bold">if</span> line<span style="color:#666">.</span>split( <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span> )[<span style="color:#666">7</span>]<span style="color:#666">.</span>startswith( <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">.</span><span style="color:#ba2121">&#39;</span> ):
      f<span style="color:#666">.</span>write( <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">{}</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">{}</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span><span style="color:#666">.</span>format( <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span><span style="color:#666">.</span>join( line<span style="color:#666">.</span>split( <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span> )[:<span style="color:#666">7</span>] ) , <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">intergenic</span><span style="color:#ba2121">&#39;</span>  ) )
    <span style="color:#008000;font-weight:bold">elif</span> line<span style="color:#666">.</span>split( <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span> )[<span style="color:#666">7</span>]<span style="color:#666">.</span>startswith( <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">ID</span><span style="color:#ba2121">&#39;</span> ):
      f<span style="color:#666">.</span>write( <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">{}</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">{}</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span><span style="color:#666">.</span>format( <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span><span style="color:#666">.</span>join( line<span style="color:#666">.</span>split( <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span> )[:<span style="color:#666">7</span>] ) , line<span style="color:#666">.</span>split( <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#39;</span> )[<span style="color:#666">7</span>]<span style="color:#666">.</span>split(<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">;</span><span style="color:#ba2121">&#39;</span>)[<span style="color:#666">0</span>][<span style="color:#666">3</span>:] ) )
f<span style="color:#666">.</span>close()
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Reading TnSeq data into a dataframe</span>

tnseq <span style="color:#666">=</span> pd<span style="color:#666">.</span>read_csv(<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">data.txt</span><span style="color:#ba2121">&#39;</span>, sep<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#34;</span>, header<span style="color:#666">=</span>None, names<span style="color:#666">=</span>[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">pos</span><span style="color:#ba2121">&#39;</span>,<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">blunt</span><span style="color:#ba2121">&#39;</span>,<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">cap</span><span style="color:#ba2121">&#39;</span>,<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">dual</span><span style="color:#ba2121">&#39;</span>,<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">erm</span><span style="color:#ba2121">&#39;</span>,<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">pen</span><span style="color:#ba2121">&#39;</span>,<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">tuf</span><span style="color:#ba2121">&#39;</span>,<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">gene</span><span style="color:#ba2121">&#39;</span>])
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Reading GC content data</span>

gc <span style="color:#666">=</span> pd<span style="color:#666">.</span>read_csv(<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">ta_gc.txt</span><span style="color:#ba2121">&#39;</span>, sep<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#b62;font-weight:bold">\t</span><span style="color:#ba2121">&#34;</span>, header<span style="color:#666">=</span>None, names<span style="color:#666">=</span>[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">pos</span><span style="color:#ba2121">&#39;</span>,<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">gc</span><span style="color:#ba2121">&#39;</span>])
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tnseq<span style="color:#666">.</span>head()
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table class="table table-striped table-responsive">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pos</th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2400002</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2400004</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2400006</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2400009</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>intergenic</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2400029</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">gc<span style="color:#666">.</span>head()
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table class="table table-striped table-responsive">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pos</th>
      <th>gc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>0.339286</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>0.354839</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16</td>
      <td>0.367647</td>
    </tr>
    <tr>
      <th>3</th>
      <td>42</td>
      <td>0.372340</td>
    </tr>
    <tr>
      <th>4</th>
      <td>79</td>
      <td>0.303922</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Join tnseq and GC content data together</span>

tn_gc <span style="color:#666">=</span> tnseq<span style="color:#666">.</span>merge(gc,left_on<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">pos</span><span style="color:#ba2121">&#39;</span>,right_on<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">pos</span><span style="color:#ba2121">&#39;</span>,how<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">left</span><span style="color:#ba2121">&#39;</span>)
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tn_gc<span style="color:#666">.</span>head()
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table class="table table-striped table-responsive">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pos</th>
      <th>blunt</th>
      <th>cap</th>
      <th>dual</th>
      <th>erm</th>
      <th>pen</th>
      <th>tuf</th>
      <th>gene</th>
      <th>gc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2400002</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
      <td>0.225490</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2400004</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
      <td>0.225490</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2400006</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
      <td>0.215686</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2400009</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>intergenic</td>
      <td>0.225490</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2400029</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>intergenic</td>
      <td>0.215686</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># This is the list of column containing construct data</span>

<span style="color:#008000">list</span>(tn_gc)[<span style="color:#666">1</span>:<span style="color:#666">7</span>]
</code></pre></div><pre><code>['blunt', 'cap', 'dual', 'erm', 'pen', 'tuf']
</code></pre>
<h2 id="melting-data">&ldquo;Melting data&rdquo;</h2>
<p>Visualization work much better with so called <a href="https://en.wikipedia.org/wiki/Wide_and_narrow_data">narrow data</a>. To convert our existing dataset into &ldquo;narrow&rdquo; form we will melt it down:</p>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/reshaping_melt.png" alt=""></p>
<p>(This image and a much more detailed explanation of dataframe reshaping can be found in <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/reshaping.html">Pandas Doc Pages</a>).</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Melt tn_gc in tdf</span>

tdf <span style="color:#666">=</span> pd<span style="color:#666">.</span>melt(tn_gc, id_vars<span style="color:#666">=</span>[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">pos</span><span style="color:#ba2121">&#39;</span>,<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">gc</span><span style="color:#ba2121">&#39;</span>,<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">gene</span><span style="color:#ba2121">&#39;</span>],value_vars<span style="color:#666">=</span><span style="color:#008000">list</span>(tn_gc)[<span style="color:#666">1</span>:<span style="color:#666">7</span>],var_name<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#34;</span>,value_name<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>)<span style="color:#666">.</span>sort_values(by<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">pos</span><span style="color:#ba2121">&#39;</span>)
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tdf<span style="color:#666">.</span>head()
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table class="table table-striped table-responsive">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pos</th>
      <th>gc</th>
      <th>gene</th>
      <th>construct</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>406329</th>
      <td>4</td>
      <td>0.339286</td>
      <td>intergenic</td>
      <td>cap</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1486729</th>
      <td>4</td>
      <td>0.339286</td>
      <td>intergenic</td>
      <td>tuf</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1216629</th>
      <td>4</td>
      <td>0.339286</td>
      <td>intergenic</td>
      <td>pen</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>676429</th>
      <td>4</td>
      <td>0.339286</td>
      <td>intergenic</td>
      <td>dual</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>136229</th>
      <td>4</td>
      <td>0.339286</td>
      <td>intergenic</td>
      <td>blunt</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Set genic and non-genic categories</span>

tdf<span style="color:#666">.</span>loc[tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">gene</span><span style="color:#ba2121">&#39;</span>] <span style="color:#666">==</span> <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">intergenic</span><span style="color:#ba2121">&#39;</span>,<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">genic</span><span style="color:#ba2121">&#39;</span>] <span style="color:#666">=</span> <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">no</span><span style="color:#ba2121">&#39;</span>
tdf<span style="color:#666">.</span>loc[tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">gene</span><span style="color:#ba2121">&#39;</span>] <span style="color:#666">!=</span> <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">intergenic</span><span style="color:#ba2121">&#39;</span>,<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">genic</span><span style="color:#ba2121">&#39;</span>] <span style="color:#666">=</span> <span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">yes</span><span style="color:#ba2121">&#39;</span>
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tdf<span style="color:#666">.</span>head()
</code></pre></div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table class="table table-striped table-responsive">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pos</th>
      <th>gc</th>
      <th>gene</th>
      <th>construct</th>
      <th>count</th>
      <th>genic</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>406329</th>
      <td>4</td>
      <td>0.339286</td>
      <td>intergenic</td>
      <td>cap</td>
      <td>1.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>1486729</th>
      <td>4</td>
      <td>0.339286</td>
      <td>intergenic</td>
      <td>tuf</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>1216629</th>
      <td>4</td>
      <td>0.339286</td>
      <td>intergenic</td>
      <td>pen</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>676429</th>
      <td>4</td>
      <td>0.339286</td>
      <td>intergenic</td>
      <td>dual</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>136229</th>
      <td>4</td>
      <td>0.339286</td>
      <td>intergenic</td>
      <td>blunt</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>
<h1 id="visualizing-the-distribution-of-a-dataset">Visualizing the distribution of a dataset</h1>
<p>When dealing with a set of data, often the first thing you’ll want to do is get a sense for how the variables are distributed. This chapter of the tutorial will give a brief introduction to some of the tools in seaborn for examining univariate and bivariate distributions. You may also want to look at the categorical plots chapter for examples of functions that make it easy to compare the distribution of a variable across levels of other variables.</p>
<p>These examples are taken from <a href="https://seaborn.pydata.org/tutorial.html">official seaborn tutorials</a>.</p>
<h2 id="plotting-univariate-distributions">Plotting univariate distributions</h2>
<p>The most convenient way to take a quick look at a univariate distribution in seaborn is the <a href="https://seaborn.pydata.org/generated/seaborn.distplot.html#seaborn.distplot"><code>distplot()</code></a> function. By default, this will draw a <a href="https://en.wikipedia.org/wiki/Histogram">histogram</a> and fit a kernel density estimate <a href="https://en.wikipedia.org/wiki/Kernel_density_estimation">KDE</a></p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Distribution of GC content </span>

sns<span style="color:#666">.</span>distplot(tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">gc</span><span style="color:#ba2121">&#39;</span>])
</code></pre></div><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f6abd8dc8d0&gt;
</code></pre>
<p><img src="/BMMB554/img/output_26_1.png" alt="png"></p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Distribution of read counts is a bit gloomy</span>

sns<span style="color:#666">.</span>distplot(tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>])
</code></pre></div><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f6ab8c66748&gt;
</code></pre>
<p><img src="/BMMB554/img/output_27_1.png" alt="png"></p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># We can narrow it down</span>

sns<span style="color:#666">.</span>distplot(tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>][(tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">6</span>)<span style="color:#666">&amp;</span>(tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&lt;</span><span style="color:#666">100</span>)])
</code></pre></div><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f6abd82e668&gt;
</code></pre>
<p><img src="/BMMB554/img/output_28_1.png" alt="png"></p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Or increase the number of bins and change the scale</span>

g<span style="color:#666">=</span>sns<span style="color:#666">.</span>distplot(tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>],bins<span style="color:#666">=</span><span style="color:#666">10000</span>)
g<span style="color:#666">.</span>set(xscale<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">log</span><span style="color:#ba2121">&#34;</span>)
</code></pre></div><pre><code>[None]
</code></pre>
<p><img src="/BMMB554/img/output_29_1.png" alt="png"></p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># And also get rid of zero counts</span>

g<span style="color:#666">=</span>sns<span style="color:#666">.</span>distplot(tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>][tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">0</span>],bins<span style="color:#666">=</span><span style="color:#666">10000</span>)
g<span style="color:#666">.</span>set(xscale<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">log</span><span style="color:#ba2121">&#34;</span>)

</code></pre></div><pre><code>[None]
</code></pre>
<p><img src="/BMMB554/img/output_30_1.png" alt="png"></p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Plotting the relationship between GC count and insertion frequency</span>

sns<span style="color:#666">.</span>jointplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">gc</span><span style="color:#ba2121">&#34;</span>, data<span style="color:#666">=</span>tdf[tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">10</span>]);
</code></pre></div><p><img src="/BMMB554/img/output_31_0.png" alt="png"></p>
<h1 id="visualizing-statistical-relationships">Visualizing statistical relationships</h1>
<p>Statistical analysis is a process of understanding how variables in a dataset relate to each other and how those relationships depend on other variables. Visualization can be a core component of this process because, when data are visualized properly, the human visual system can see trends and patterns that indicate a relationship.</p>
<p>We will discuss three seaborn functions in this tutorial. The one we will use most is <a href="https://seaborn.pydata.org/generated/seaborn.relplot.html#seaborn.relplot"> <code>relplot()</code></a>. This is a <a href="https://seaborn.pydata.org/introduction.html#intro-func-types">figure-level function</a> for visualizing statistical relationships using two common approaches: scatter plots and line plots. <a href="https://seaborn.pydata.org/generated/seaborn.relplot.html#seaborn.relplot"> <code>relplot()</code></a> combines a <a href="https://seaborn.pydata.org/generated/seaborn.FacetGrid.html#seaborn.FacetGrid">FacetGrid</a> with one of two axes-level functions:</p>
<ul>
<li><a href="https://seaborn.pydata.org/generated/seaborn.scatterplot.html#seaborn.scatterplot"><code>scatterplot()</code></a> (with <code>kind=&quot;scatter&quot;</code>; the default)</li>
<li><a href="https://seaborn.pydata.org/generated/seaborn.lineplot.html#seaborn.lineplot"><code>lineplot()</code></a> (with <code>kind=&quot;line&quot;</code>)</li>
</ul>
<p>As we will see, these functions can be quite illuminating because they use simple and easily-understood representations of data that can nevertheless represent complex dataset structures. They can do so because they plot two-dimensional graphics that can be enhanced by mapping up to three additional variables using the semantics of hue, size, and style.</p>
<h2 id="relating-variables-with-scatter-plots">Relating variables with scatter plots</h2>
<p>The scatter plot is a mainstay of statistical visualization. It depicts the joint distribution of two variables using a cloud of points, where each point represents an observation in the dataset. This depiction allows the eye to infer a substantial amount of information about whether there is any meaningful relationship between them.</p>
<p>There are several ways to draw a scatter plot in seaborn. The most basic, which should be used when both variables are numeric, is the <a href="https://seaborn.pydata.org/generated/seaborn.scatterplot.html#seaborn.scatterplot"><code>scatterplot()</code></a> function. The <a href="https://seaborn.pydata.org/generated/seaborn.scatterplot.html#seaborn.scatterplot"><code>scatterplot()</code></a> is the default kind in <a href="https://seaborn.pydata.org/generated/seaborn.relplot.html#seaborn.relplot"><code>relplot()</code></a> (it can also be forced by setting <code>kind=&quot;scatter&quot;</code>):</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>relplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">gc</span><span style="color:#ba2121">&#39;</span>,y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>,data<span style="color:#666">=</span>tdf[tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">100</span>])
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa132ae80&gt;
</code></pre>
<p><img src="/BMMB554/img/output_34_1.png" alt="png"></p>
<p>While the points are plotted in two dimensions, another dimension can be added to the plot by coloring the points according to a third variable. In seaborn, this is referred to as using a “hue semantic”, because the color of the point gains meaning:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>relplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">gc</span><span style="color:#ba2121">&#39;</span>,y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>,data<span style="color:#666">=</span>tdf[tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">100</span>],hue<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#39;</span>)
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa10d68d0&gt;
</code></pre>
<p><img src="/BMMB554/img/output_36_1.png" alt="png"></p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Here we change y axis to log scale</span>

g <span style="color:#666">=</span> sns<span style="color:#666">.</span>relplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">gc</span><span style="color:#ba2121">&#39;</span>,y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>,data<span style="color:#666">=</span>tdf[tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">100</span>],hue<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#39;</span>)
g<span style="color:#666">.</span>set(yscale<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">log</span><span style="color:#ba2121">&#34;</span>)
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa0ec19e8&gt;
</code></pre>
<p><img src="/BMMB554/img/output_37_1.png" alt="png"></p>
<p>To emphasize the difference between the classes, and to improve accessibility, you can use a different marker style for each class:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>relplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">gc</span><span style="color:#ba2121">&#39;</span>,y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>,data<span style="color:#666">=</span>tdf[tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">100</span>],hue<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#39;</span>,style<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">genic</span><span style="color:#ba2121">&#39;</span>)
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa0a590f0&gt;
</code></pre>
<p><img src="/BMMB554/img/output_39_1.png" alt="png"></p>
<h1 id="categorical-scatterplots">Categorical scatterplots</h1>
<p>The default representation of the data in <a href="https://seaborn.pydata.org/generated/seaborn.catplot.html#seaborn.catplot"><code>catplot()</code></a> uses a scatterplot. There are actually two different categorical scatter plots in seaborn. They take different approaches to resolving the main challenge in representing categorical data with a scatter plot, which is that all of the points belonging to one category would fall on the same position along the axis corresponding to the categorical variable. The approach used by <a href="https://seaborn.pydata.org/generated/seaborn.stripplot.html#seaborn.stripplot"><code>stripplot()</code></a>, which is the default “kind” in <a href="https://seaborn.pydata.org/generated/seaborn.catplot.html#seaborn.catplot"><code>catplot()</code></a> is to adjust the positions of points on the categorical axis with a small amount of random “jitter”:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>catplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>, data<span style="color:#666">=</span>tdf[tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">100</span>]);
</code></pre></div><p><img src="/BMMB554/img/output_41_0.png" alt="png"></p>
<p>The <code>jitter</code> parameter controls the magnitude of jitter or disables it altogether:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>catplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>, data<span style="color:#666">=</span>tdf[tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">100</span>],jitter<span style="color:#666">=</span>False);
</code></pre></div><p><img src="/BMMB554/img/output_43_0.png" alt="png"></p>
<p>The second approach adjusts the points along the categorical axis using an algorithm that prevents them from overlapping. It can give a better representation of the distribution of observations, although it only works well for relatively small datasets. This kind of plot is sometimes called a “beeswarm” and is drawn in seaborn by <a href="https://seaborn.pydata.org/generated/seaborn.swarmplot.html#seaborn.swarmplot"><code>swarmplot()</code></a>, which is activated by setting <code>kind=&quot;swarm&quot;</code> in <a href="https://seaborn.pydata.org/generated/seaborn.catplot.html#seaborn.catplot"><code>catplot()</code></a>:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>catplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>, data<span style="color:#666">=</span>tdf[tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">100</span>],kind<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">swarm</span><span style="color:#ba2121">&#34;</span>)
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa0df8cc0&gt;
</code></pre>
<p><img src="/BMMB554/img/output_45_1.png" alt="png"></p>
<p>Similar to the relational plots, it’s possible to add another dimension to a categorical plot by using a <code>hue</code> semantic. (The categorical plots do not currently support <code>size</code> or <code>style</code> semantics). Each different categorical plotting function handles the <code>hue</code> semantic differently. For the scatter plots, it is only necessary to change the color of the points:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>catplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>, data<span style="color:#666">=</span>tdf[tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">100</span>],kind<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">swarm</span><span style="color:#ba2121">&#34;</span>,hue<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">genic</span><span style="color:#ba2121">&#39;</span>)
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa0ee0e48&gt;
</code></pre>
<p><img src="/BMMB554/img/output_47_1.png" alt="png"></p>
<p>We’ve referred to the idea of “categorical axis”. In these examples, that’s always corresponded to the horizontal axis. But it’s often helpful to put the categorical variable on the vertical axis (particularly when the category names are relatively long or there are many categories). To do this, swap the assignment of variables to axes:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>catplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#34;</span>, data<span style="color:#666">=</span>tdf[tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">100</span>],kind<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">swarm</span><span style="color:#ba2121">&#34;</span>,hue<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">genic</span><span style="color:#ba2121">&#39;</span>)
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa0df8898&gt;
</code></pre>
<p><img src="/BMMB554/img/output_49_1.png" alt="png"></p>
<h2 id="distributions-of-observations-within-categories">Distributions of observations within categories</h2>
<p>As the size of the dataset grows,, categorical scatter plots become limited in the information they can provide about the distribution of values within each category. When this happens, there are several approaches for summarizing the distributional information in ways that facilitate easy comparisons across the category levels.</p>
<h3 id="boxplots">Boxplots</h3>
<p>The first is the familiar <a href="https://seaborn.pydata.org/generated/seaborn.boxplot.html#seaborn.boxplot"><code>boxplot()</code></a>. This kind of plot shows the three quartile values of the distribution along with extreme values. The “whiskers” extend to points that lie within 1.5 IQRs of the lower and upper quartile, and then observations that fall outside this range are displayed independently. This means that each value in the boxplot corresponds to an actual observation in the data.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>catplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>, data<span style="color:#666">=</span>tdf[(tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">10</span>) <span style="color:#666">&amp;</span> (tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&lt;</span><span style="color:#666">100</span>)],kind<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">box</span><span style="color:#ba2121">&#34;</span>)
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa0f97a58&gt;
</code></pre>
<p><img src="/BMMB554/img/output_52_1.png" alt="png"></p>
<p>When adding a <code>hue</code> semantic, the box for each level of the semantic variable is moved along the categorical axis so they don’t overlap:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>catplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>, data<span style="color:#666">=</span>tdf[(tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">10</span>) <span style="color:#666">&amp;</span> (tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&lt;</span><span style="color:#666">100</span>)],kind<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">box</span><span style="color:#ba2121">&#34;</span>,hue<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">genic</span><span style="color:#ba2121">&#39;</span>)
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa1054e80&gt;
</code></pre>
<p><img src="/BMMB554/img/output_54_1.png" alt="png"></p>
<p>A related function, <a href="https://seaborn.pydata.org/generated/seaborn.boxenplot.html#seaborn.boxenplot"><code>boxenplot()</code></a>, draws a plot that is similar to a box plot but optimized for showing more information about the shape of the distribution. It is best suited for larger datasets:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>catplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>, data<span style="color:#666">=</span>tdf[(tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">10</span>) <span style="color:#666">&amp;</span> (tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&lt;</span><span style="color:#666">100</span>)],kind<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">boxen</span><span style="color:#ba2121">&#34;</span>)
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa132ad68&gt;
</code></pre>
<p><img src="/BMMB554/img/output_56_1.png" alt="png"></p>
<h3 id="violinplots">Violinplots</h3>
<p>A different approach is a <a href="https://seaborn.pydata.org/generated/seaborn.violinplot.html#seaborn.violinplot"><code>violinplot()</code></a>, which combines a boxplot with the kernel density estimation procedure:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>catplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>, data<span style="color:#666">=</span>tdf[(tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">10</span>) <span style="color:#666">&amp;</span> (tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&lt;</span><span style="color:#666">100</span>)],kind<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">violin</span><span style="color:#ba2121">&#34;</span>)
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa144b320&gt;
</code></pre>
<p><img src="/BMMB554/img/output_58_1.png" alt="png"></p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>catplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>, data<span style="color:#666">=</span>tdf[(tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">10</span>) <span style="color:#666">&amp;</span> (tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&lt;</span><span style="color:#666">100</span>)],kind<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">violin</span><span style="color:#ba2121">&#34;</span>,hue<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">genic</span><span style="color:#ba2121">&#39;</span>)
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa159e358&gt;
</code></pre>
<p><img src="/BMMB554/img/output_59_1.png" alt="png"></p>
<p>It’s also possible to “split” the violins when the hue parameter has only two levels, which can allow for a more efficient use of space:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>catplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>, data<span style="color:#666">=</span>tdf[(tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">10</span>) <span style="color:#666">&amp;</span> (tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&lt;</span><span style="color:#666">100</span>)],kind<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">violin</span><span style="color:#ba2121">&#34;</span>,hue<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">genic</span><span style="color:#ba2121">&#39;</span>,split<span style="color:#666">=</span>True)
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa145efd0&gt;
</code></pre>
<p><img src="/BMMB554/img/output_61_1.png" alt="png"></p>
<p>Finally, there are several options for the plot that is drawn on the interior of the violins, including ways to show each individual observation instead of the summary boxplot values:</p>
<h2 id="statistical-estimation-within-categories">Statistical estimation within categories</h2>
<p>For other applications, rather than showing the distribution within each category, you might want to show an estimate of the central tendency of the values. Seaborn has two main ways to show this information. Importantly, the basic API for these functions is identical to that for the ones discussed above.</p>
<h3 id="bar-plots">Bar plots</h3>
<p>A familiar style of plot that accomplishes this goal is a bar plot. In seaborn, the <a href="https://seaborn.pydata.org/generated/seaborn.barplot.html#seaborn.barplot"><code>barplot()</code></a> function operates on a full dataset and applies a function to obtain the estimate (taking the mean by default). When there are multiple observations in each category, it also uses bootstrapping to compute a confidence interval around the estimate and plots that using error bars:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>catplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#34;</span>,y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>,hue<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">genic</span><span style="color:#ba2121">&#34;</span>,kind<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">bar</span><span style="color:#ba2121">&#34;</span>,data<span style="color:#666">=</span>tdf)
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa167ea90&gt;
</code></pre>
<p><img src="/BMMB554/img/output_65_1.png" alt="png"></p>
<p>A special case for the bar plot is when you want to show the number of observations in each category rather than computing a statistic for a second variable. This is similar to a histogram over a categorical, rather than quantitative, variable. In seaborn, it’s easy to do so with the <a href="https://seaborn.pydata.org/generated/seaborn.countplot.html#seaborn.countplot"><code>countplot()</code></a> function:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>catplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">genic</span><span style="color:#ba2121">&#34;</span>,kind<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>,data<span style="color:#666">=</span>tdf)
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa1340ef0&gt;
</code></pre>
<p><img src="/BMMB554/img/output_67_1.png" alt="png"></p>
<h2 id="showing-multiple-relationships-with-facets">Showing multiple relationships with facets</h2>
<p>Just like <a href="https://seaborn.pydata.org/generated/seaborn.relplot.html#seaborn.relplot"><code>relplot()</code></a>, the fact that <a href="https://seaborn.pydata.org/generated/seaborn.catplot.html#seaborn.catplot"><code>catplot()</code></a> is built on a <a href="https://seaborn.pydata.org/generated/seaborn.FacetGrid.html#seaborn.FacetGrid"><code>FacetGrid</code></a> means that it is easy to add faceting variables to visualize higher-dimensional relationships:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#666">.</span>catplot(x<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">genic</span><span style="color:#ba2121">&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#34;</span>, data<span style="color:#666">=</span>tdf[(tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&gt;</span><span style="color:#666">10</span>) <span style="color:#666">&amp;</span> (tdf[<span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">count</span><span style="color:#ba2121">&#39;</span>]<span style="color:#666">&lt;</span><span style="color:#666">1000</span>)],kind<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#34;</span><span style="color:#ba2121">boxen</span><span style="color:#ba2121">&#34;</span>,col<span style="color:#666">=</span><span style="color:#ba2121"></span><span style="color:#ba2121">&#39;</span><span style="color:#ba2121">construct</span><span style="color:#ba2121">&#39;</span>,col_wrap<span style="color:#666">=</span><span style="color:#666">2</span>)
</code></pre></div><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6aa0d0b588&gt;
</code></pre>
<p><img src="/BMMB554/img/output_69_1.png" alt="png"></p>



      </main>
    </div>
    <footer id="footer" class="mt-auto text-center text-muted">
  <div class="container">
    Nekrutenko Lab 2020 | CC-BY
  </div>
</footer>
    <script src="https://nekrut.github.io/BMMB554/js/feather.min.js"></script>
<script>
  feather.replace()
</script>


    
  

  </body>
</html>